id: PYSEC-0000-CVE-2023-47641
severity:
- type: CVSS_V3
  score: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
details: aiohttp is an asynchronous HTTP client/server framework for asyncio and Python.
  Affected versions of aiohttp have a security vulnerability regarding the inconsistent
  interpretation of the http protocol. HTTP/1.1 is a persistent protocol, if both
  Content-Length(CL) and Transfer-Encoding(TE) header values are present it can lead
  to incorrect interpretation of two entities that parse the HTTP and we can poison
  other sockets with this incorrect interpretation. A possible Proof-of-Concept (POC)
  would be a configuration with a reverse proxy(frontend) that accepts both CL and
  TE headers and aiohttp as backend. As aiohttp parses anything with chunked, we can
  pass a chunked123 as TE, the frontend entity will ignore this header and will parse
  Content-Length. The impact of this vulnerability is that it is possible to bypass
  any proxy rule, poisoning sockets to other users like passing Authentication Headers,
  also if it is present an Open Redirect an attacker could combine it to redirect
  random users to another website and log the request. This vulnerability has been
  addressed in release 3.8.0 of aiohttp. Users are advised to upgrade. There are no
  known workarounds for this vulnerability.
affected:
- package:
    name: aiohttp
    ecosystem: PyPI
    purl: pkg:pypi/aiohttp
  ranges:
  - type: GIT
    repo: https://github.com/aio-libs/aiohttp
    events:
    - introduced: "0"
    - fixed: f016f0680e4ace6742b03a70cb0382ce86abe371
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 3.8.0
references:
- type: EVIDENCE
  url: https://github.com/aio-libs/aiohttp/security/advisories/GHSA-xx9p-xxvh-7g8j
- type: FIX
  url: https://github.com/aio-libs/aiohttp/security/advisories/GHSA-xx9p-xxvh-7g8j
- type: ADVISORY
  url: https://github.com/aio-libs/aiohttp/security/advisories/GHSA-xx9p-xxvh-7g8j
- type: FIX
  url: https://github.com/aio-libs/aiohttp/commit/f016f0680e4ace6742b03a70cb0382ce86abe371
aliases:
- CVE-2023-47641
- GHSA-xx9p-xxvh-7g8j
modified: "2023-11-22T22:41:00Z"
published: "2023-11-14T21:15:00Z"
