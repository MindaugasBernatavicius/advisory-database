id: PYSEC-0000-CVE-2023-40015
severity:
- type: CVSS_V3
  score: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
details: 'Vyper is a Pythonic Smart Contract Language. For the following (probably
  non-exhaustive) list of expressions, the compiler evaluates the arguments from right
  to left instead of left to right. `unsafe_add, unsafe_sub, unsafe_mul, unsafe_div,
  pow_mod256, |, &, ^ (bitwise operators), bitwise_or (deprecated), bitwise_and (deprecated),
  bitwise_xor (deprecated), raw_call, <, >, <=, >=, ==, !=, in, not in (when lhs and
  rhs are enums)`. This behaviour becomes a problem when the evaluation of one of
  the arguments produces side effects that other arguments depend on. The following
  expressions can produce side-effect: state modifying external call , state modifying
  internal call, `raw_call`, `pop()` when used on a Dynamic Array stored in the storage,
  `create_minimal_proxy_to`, `create_copy_of`, `create_from_blueprint`. This issue
  has not yet been patched. Users are advised to make sure that the arguments of the
  expression do not produce side effects or, if one does, that no other argument is
  dependent on those side effects.'
affected:
- package:
    name: vyper
    ecosystem: PyPI
    purl: pkg:pypi/vyper
  ranges:
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 0.3.10rc1
references:
- type: EVIDENCE
  url: https://github.com/vyperlang/vyper/security/advisories/GHSA-g2xh-c426-v8mf
- type: ADVISORY
  url: https://github.com/vyperlang/vyper/security/advisories/GHSA-g2xh-c426-v8mf
aliases:
- CVE-2023-40015
- GHSA-g2xh-c426-v8mf
modified: "2023-09-08T13:58:00Z"
published: "2023-09-04T18:15:00Z"
