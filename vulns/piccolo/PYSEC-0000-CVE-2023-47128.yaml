id: PYSEC-0000-CVE-2023-47128
severity:
- type: CVSS_V3
  score: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
details: 'Piccolo is an object-relational mapping and query builder which supports
  asyncio. Prior to version 1.1.1, the handling of named transaction `savepoints`
  in all database implementations is vulnerable to SQL Injection via f-strings. While
  the likelihood of an end developer exposing a `savepoints` `name` parameter to a
  user is highly unlikely, it would not be unheard of. If a malicious user was able
  to abuse this functionality they would have essentially direct access to the database
  and the ability to modify data to the level of permissions associated with the database
  user. A non exhaustive list of actions possible based on database permissions is:
  Read all data stored in the database, including usernames and password hashes; insert
  arbitrary data into the database, including modifying existing records; and gain
  a shell on the underlying server. Version 1.1.1 fixes this issue.'
affected:
- package:
    name: piccolo
    ecosystem: PyPI
    purl: pkg:pypi/piccolo
  ranges:
  - type: GIT
    repo: https://github.com/piccolo-orm/piccolo
    events:
    - introduced: "0"
    - fixed: 82679eb8cd1449cf31d87c9914a072e70168b6eb
  - type: ECOSYSTEM
    events:
    - introduced: "0"
references:
- type: EVIDENCE
  url: https://github.com/piccolo-orm/piccolo/security/advisories/GHSA-xq59-7jf3-rjc6
- type: ADVISORY
  url: https://github.com/piccolo-orm/piccolo/security/advisories/GHSA-xq59-7jf3-rjc6
- type: FIX
  url: https://github.com/piccolo-orm/piccolo/commit/82679eb8cd1449cf31d87c9914a072e70168b6eb
aliases:
- CVE-2023-47128
- GHSA-xq59-7jf3-rjc6
modified: "2023-11-20T19:35:00Z"
published: "2023-11-10T18:15:00Z"
